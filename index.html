<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QTc Calculator â€“ ClinicalToolsDEV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#050810" />

  <!-- PWA manifest & icons -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon-180.png" />

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-shell">
    <header class="app-header">
      <h1 class="app-title">QTc Calculator</h1>
      <p class="app-subtitle">
        Corrected QT interval using Bazett, Fridericia, Framingham, Hodges &amp; Rautaharju
        for narrow QRS, and Bogossian + Rautaharju methods for wide QRS.
      </p>

      <div class="app-meta">
        <span class="app-badge">CLINICALTOOLSDEV</span>
      </div>
    </header>

    <main class="app-main">
      <!-- Inputs -->
      <section class="card card-inputs">
        <h2 class="card-title">Inputs</h2>
        <form id="tool-form" class="form-grid">
          <!-- QRS Type -->
          <div class="form-field">
            <label for="qrsType" class="field-label">QRS Type</label>
            <select id="qrsType" name="qrsType" class="field-input">
              <option value="narrow">Narrow Complex QRS (&lt;120 ms)</option>
              <option value="wide">Wide Complex QRS (&ge;120 ms)</option>
            </select>
            <p class="field-help">
              Select based on QRS duration. Wide QRS mode will prompt for QRS and gender.
            </p>
          </div>

          <!-- HR -->
          <div class="form-field">
            <label for="heartRate" class="field-label">Heart Rate (bpm)</label>
            <input
              id="heartRate"
              name="heartRate"
              type="number"
              step="1"
              class="field-input"
              required
            />
            <p class="field-help">Measured ventricular rate in beats per minute.</p>
          </div>

          <!-- QT -->
          <div class="form-field">
            <label for="qtInterval" class="field-label">QT Interval (ms)</label>
            <input
              id="qtInterval"
              name="qtInterval"
              type="number"
              step="1"
              class="field-input"
              required
            />
            <p class="field-help">Onset of QRS to end of T wave, in milliseconds.</p>
          </div>

          <!-- QRS (wide-mode only) -->
          <div class="form-field wide-only">
            <label for="qrsDuration" class="field-label">QRS Duration (ms)</label>
            <input
              id="qrsDuration"
              name="qrsDuration"
              type="number"
              step="1"
              class="field-input"
            />
            <p class="field-help">
              Required for wide QRS (e.g., BBB, paced rhythm, IVCD).
            </p>
          </div>

          <!-- Gender (wide-mode only, for Rautaharju wide) -->
          <div class="form-field wide-only">
            <span class="field-label">Gender (for Rautaharju wide)</span>
            <div class="field-radio-row">
              <label class="radio-option">
                <input
                  type="radio"
                  name="gender"
                  value="male"
                  checked
                />
                <span>Male</span>
              </label>
              <label class="radio-option">
                <input
                  type="radio"
                  name="gender"
                  value="female"
                />
                <span>Female</span>
              </label>
            </div>
            <p class="field-help">
              Used only for wide QRS Rautaharju QTc. Narrow QRS modes use a sex-neutral
              Rautaharju variant.
            </p>
          </div>

          <button type="submit" class="btn-primary">
            Calculate QTc
          </button>
        </form>
      </section>

      <!-- Results -->
      <section class="card card-results">
        <h2 class="card-title">Results</h2>
        <div id="results-container" class="results-body">
          <p class="results-placeholder">
            Enter values and click "Calculate QTc" to view results.
          </p>
        </div>

        <!-- Collapsible formulas -->
        <details class="collapsible">
          <summary class="collapsible-summary">Show QTc formulas</summary>
          <div class="collapsible-body">
            <p class="collapsible-intro">
              All formulas assume QT and QRS in milliseconds and RR in seconds.
            </p>
            <ul class="formula-list">
              <li>
                <strong>Bazett</strong> (Bazett 1920)<br />
                QTc = QT / âˆšRR
              </li>
              <li>
                <strong>Fridericia</strong> (Fridericia 1920)<br />
                QTc = QT / RR<sup>1/3</sup>
              </li>
              <li>
                <strong>Framingham</strong> (Sagie et al. 1992)<br />
                QTc = QT + 154 &times; (1 âˆ’ RR)
              </li>
              <li>
                <strong>Hodges</strong> (Hodges et al. 1983)<br />
                QTc = QT + 1.75 &times; [(60 / RR) âˆ’ 60]
              </li>
              <li>
                <strong>Rautaharju (HR-based, narrow QRS)</strong><br />
                QTc = QT &times; (120 + HR) / 180
              </li>
              <li>
                <strong>Bogossian method (wide QRS)</strong><br />
                QT<sub>m</sub> = QT âˆ’ 0.5 &times; QRS<br />
                QTc<sub>Fridericia</sub> = QT<sub>m</sub> / RR<sup>1/3</sup>
              </li>
              <li>
                <strong>Rautaharju wide-QRS (QT8)</strong><br />
                QTc = QT âˆ’ 155 &times; (60 / HR âˆ’ 1) âˆ’ 0.93 &times; (QRS âˆ’ 139) + k<br />
                k = âˆ’22 ms (men), k = âˆ’34 ms (women)
              </li>
            </ul>
          </div>
        </details>

        <!-- Collapsible references -->
        <details class="collapsible">
          <summary class="collapsible-summary">Show references</summary>
          <div class="collapsible-body">
            <ol class="references-list">
              <li>
                Bazett HC. An analysis of the time-relations of electrocardiograms.
                <em>Heart</em>. 1920;7:353â€“70.
              </li>
              <li>
                Fridericia LS. Die Systolendauer im Elektrokardiogramm bei normalen
                Menschen und bei Herzkranken. <em>Acta Med Scand</em>. 1920;53:469â€“486.
                (Translated reprint: <em>Ann Noninvasive Electrocardiol</em>.
                2003;8(4):343â€“51.)
              </li>
              <li>
                Sagie A, Larson MG, Goldberg RJ, Bengtson JR, Levy D.
                An improved method for adjusting the QT interval for heart rate
                (the Framingham Heart Study). <em>Am J Cardiol</em>.
                1992;70(7):797â€“801.
              </li>
              <li>
                Hodges MS, Salerno D, Erlinen D. Bazett's QT correction reviewed:
                evidence that a linear QT correction for heart rate is better.
                <em>J Am Coll Cardiol</em>. 1983;1:694.
              </li>
              <li>
                Rautaharju PM, Mason JW, Akiyama T. New age- and sex-specific criteria
                for QT prolongation based on rate correction formulas that minimize
                bias at the upper normal limits. <em>Int J Cardiol</em>. 2014;174:535â€“40.
              </li>
              <li>
                Rautaharju PM, Zhang ZM. Linearly scaled, rate-invariant normal limits
                for QT interval: eight decades of incorrect application of power
                functions. <em>J Cardiovasc Electrophysiol</em>. 2002;13:1211â€“1218.
              </li>
            </ol>
          </div>
        </details>
      </section>

      <!-- Flags & Notes -->
      <section class="card card-warnings">
        <h2 class="card-title">Flags &amp; Notes</h2>
        <div id="flags-container" class="flags-body">
          <p class="results-placeholder">
            Any critical values, red flags, or important notes will appear here.
          </p>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <p class="disclaimer">
        This tool is for educational and decision-support purposes only. It does
        not replace clinical judgment, institutional guidelines, or specialist
        consultation. QT and QTc values must be interpreted in full clinical context.
      </p>
    </footer>
  </div>

  <!-- iOS INSTALL BANNER -->
  <div id="ios-install-hint" class="ios-install-hint ios-install-hint-hidden">
    <div class="ios-install-hint-icon">ðŸ“±</div>
    <div class="ios-install-hint-text">
      <strong>Install this app</strong><br />
      On iPhone: tap the <strong>Share</strong> button, then choose
      <strong>Add to Home Screen</strong>.
    </div>
    <button type="button" class="ios-install-hint-close" aria-label="Dismiss">
      CLOSE
    </button>
  </div>

  <!-- Existing JS -->
  <script src="script.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("./service-worker.js")
          .catch(err => console.error("Service worker registration failed:", err));
      });
    }
  </script>

  <!-- iOS Install Hint Script -->
  <script src="ios-install-hint.js"></script>
</body>
</html>

